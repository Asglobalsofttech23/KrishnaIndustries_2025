import{ab as ue,r as s,c as pe,d as me,j as e,G as r,B as je,h as u,a4 as k,F as fe,a7 as ge,a5 as o,X as Ce,Y as be,Z as ye,$ as Se,a0 as I,a1 as l,a2 as _e,ac as ve,S as De,U as we,W as Le,a3 as Pe}from"./index-DFpI35T6.js";import{h as b}from"./moment-G82_0lEo.js";import{T as Te,a as B,U as ke}from"./UpdateFlwLeads-BtYv_8Dd.js";import{P as Ee}from"./Pagination-WAac2fOa.js";const We=()=>{const O=ue(),[h,$]=s.useState([]),[E,Y]=s.useState(null),[y,U]=s.useState(null),[S,_]=s.useState([]),[p,F]=s.useState(5),[v,D]=s.useState(1),[Q,V]=s.useState([]),[G,A]=s.useState([]),[d,W]=s.useState(""),[m,R]=s.useState(""),[c,M]=s.useState("");sessionStorage.getItem("emp_id");const[j,q]=s.useState(1),[N,f]=s.useState(!1),[H,X]=s.useState([]);s.useState(!1),s.useState([]),s.useState(!1),s.useState([]);const[w,Z]=s.useState(""),[L,J]=s.useState(""),[P,K]=s.useState("");s.useEffect(()=>{pe.get(`${me.apiUrl}/leads/empFollowLeadsForAdmin`).then(t=>{const a=new Set(t.data.map(n=>n.leads_state));V([...a]),$(t.data),_(t.data)}).catch(t=>{console.log("Leads data is not fetched.",t)})},[N]),s.useEffect(()=>{if(d){const t=new Set(h.filter(a=>a.leads_state===d).map(a=>a.leads_city));A([...t])}else A([])},[d]),s.useEffect(()=>{const t=b().format("YYYY-MM-DD"),a=h.filter(n=>{const i=c===""||n.leads_name.toLowerCase().includes(c.toLowerCase())||n.leads_name.toUpperCase().includes(c.toUpperCase)||n.leads_email.toLowerCase().includes(c.toLowerCase())||n.leads_email.toUpperCase().includes(c.toUpperCase())||n.leads_mobile.includes(c),x=d===""||n.leads_state===d,g=m===""||n.leads_city===m,C=j===1||j===2&&b(n.created_at).format("YYYY-MM-DD")===t;return i&&x&&g&&C});_(a)},[c,d,m,j,h]);const ee=t=>{const a=parseInt(t.target.value,10);a==1?(F(h.length),D(1)):(F(a),D(1))},te=(v-1)*p,ae=v*p,se=S?S.slice(te,ae):[],le=()=>{W(""),R(""),M(""),_(h)},ne=t=>{const a=h.find(n=>n.follow_id===t);a&&(X(a),f(!0))},oe=(t,a)=>{Y(t.currentTarget),U(a)},z=()=>{Y(null),U(null)},T=(t,a)=>{z(),O(`/${t}/${a}`)},re=!!E,ie=()=>{const t=h.filter(g=>{const C=b(g.created_at).format("YYYY-MM-DD"),he=(!w||C>=w)&&(!L||C<=L),xe=!P||g.emp_name.toLowerCase().includes(P.toLowerCase());return he&&xe}),a=de(t),n=new Blob([a],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),x=URL.createObjectURL(n);i.href=x,i.setAttribute("download","filtered_employee_data.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i)},de=t=>{const a=["follow_id","emp_id","emp_name","leads_id","leads_name","leads_mobile","leads_email","product_name","leads_company","Description","Call_Discussion","remember","reminder_date","leads_address","leads_state","leads_city","call_Attended","gst_number","created_at"],n=t.map(i=>a.map(x=>i[x]||"").join(","));return`${a.join(",")}
${n.join(`
`)}`},ce={backgroundColor:"green",fontWeight:"bold",color:"white"};return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h1",{className:"text-center",children:"Followed Leads Index"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:8,children:e.jsx(je,{sx:{width:"100%",bgcolor:"background.paper"},children:e.jsxs(Te,{value:j,onChange:(t,a)=>q(a),centered:!0,children:[e.jsx(B,{label:"All Leads",value:1}),e.jsx(B,{label:"Today's Leads",value:2})]})})}),e.jsx(r,{item:!0,xs:4,display:"flex",justifyContent:"end",children:e.jsx(u,{variant:"outlined",onClick:le,children:"Cancel Filters"})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsx(k,{fullWidth:!0,label:"Search",placeholder:"Search by name, email, or mobile",onChange:t=>M(t.target.value),value:c})}),e.jsx(r,{item:!0,xs:6,children:e.jsx(fe,{fullWidth:!0,children:e.jsxs(ge,{value:p,onChange:ee,children:[e.jsx(o,{value:5,children:"5 Per Page"}),e.jsx(o,{value:10,children:"10 Per Page"}),e.jsx(o,{value:15,children:"15 Per Page"}),e.jsx(o,{value:1,children:"All Per Page"})]})})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsxs(k,{fullWidth:!0,select:!0,label:"Select State",value:d,onChange:t=>W(t.target.value),children:[e.jsx(o,{value:"",children:"All States"}),Q.map((t,a)=>e.jsx(o,{value:t,children:t},a))]})}),e.jsx(r,{item:!0,xs:6,children:e.jsxs(k,{fullWidth:!0,select:!0,label:"Select City",value:m,onChange:t=>R(t.target.value),disabled:!d,children:[e.jsx(o,{value:"",children:"All Cities"}),G.map((t,a)=>e.jsx(o,{value:t,children:t},a))]})})]}),e.jsxs("div",{style:{padding:"20px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:[e.jsx("h3",{style:{textAlign:"center",padding:"10px",color:"red"},children:"Download Employee Reports"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"15px",justifyContent:"center"},children:[e.jsx("label",{style:{fontWeight:"bold",fontSize:"14px"},children:"Employee Name:"}),e.jsx("input",{type:"text",value:P,onChange:t=>K(t.target.value),placeholder:"Enter employee name",style:{padding:"8px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"}}),e.jsx("label",{style:{fontWeight:"bold",fontSize:"14px"},children:"Start Date:"}),e.jsx("input",{type:"date",value:w,onChange:t=>Z(t.target.value),style:{padding:"8px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"}}),e.jsx("label",{style:{fontWeight:"bold",fontSize:"14px"},children:"End Date:"}),e.jsx("input",{type:"date",value:L,onChange:t=>J(t.target.value),style:{padding:"8px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"15px"},children:e.jsx(u,{variant:"contained",color:"primary",onClick:ie,style:{padding:"10px 20px",fontWeight:"bold",borderRadius:"6px",backgroundColor:"#007bff",color:"#fff"},children:"Download Employee Data"})})]}),e.jsx(Ce,{component:be,style:{marginTop:"20px"},children:e.jsxs(ye,{children:[e.jsx(Se,{children:e.jsxs(I,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:[e.jsx(l,{children:"S.No"}),e.jsx(l,{children:"Employee Name"}),e.jsx(l,{children:"Leads Name"}),e.jsx(l,{children:"Leads Mobile"}),e.jsx(l,{children:"Leads Email"}),e.jsx(l,{children:"Leads Company"}),e.jsx(l,{children:"State"}),e.jsx(l,{children:"City"}),e.jsx(l,{children:"Reminder Date"}),e.jsx(l,{children:"Action"})]})}),e.jsx(_e,{children:se.map((t,a)=>e.jsxs(I,{children:[e.jsx(l,{children:a+1}),e.jsx(l,{children:t.emp_name}),e.jsx(l,{children:t.leads_name}),e.jsx(l,{children:t.leads_mobile}),e.jsx(l,{children:t.leads_email}),e.jsx(l,{children:t.leads_company}),e.jsx(l,{children:t.leads_state}),e.jsx(l,{children:t.leads_city}),e.jsx(l,{style:ce,children:b(t.reminder_date).format("YYYY-MM-DD")}),e.jsxs(l,{children:[e.jsx(u,{variant:"outlined",onClick:n=>oe(n,t),children:"Quotation"}),e.jsxs(ve,{open:re&&(y==null?void 0:y.follow_id)===t.follow_id,anchorEl:E,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[e.jsx(o,{onClick:()=>T("quotation",t.follow_id),children:"Quotation"}),e.jsx(o,{onClick:()=>T("proforma",t.follow_id),children:"Proforma"}),e.jsx(o,{onClick:()=>T("invoice",t.follow_id),children:"Invoice"})]}),e.jsx(u,{onClick:()=>ne(t.follow_id),children:"Edit"})]})]},a))})]})}),e.jsx(r,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(De,{spacing:2,children:e.jsx(Ee,{count:Math.ceil(S.length/p),page:v,onChange:(t,a)=>D(a),size:"small"})})}),e.jsxs(we,{open:N,onClose:()=>f(!1),maxWidth:"md",children:[e.jsx(Le,{children:e.jsx(ke,{data:H,onClose:()=>f(!1)})}),e.jsx(Pe,{children:e.jsx(u,{onClick:()=>f(!1),children:"Close"})})]})]})};export{We as default};
